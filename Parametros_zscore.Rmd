---
title: "Dados de Parâmetros Z-Score"
output: html_notebook
date: "2024-05-09"
---

```{r}
knitr::opts_chunk$set(
  message=FALSE, 
  warning=FALSE,
  fig.cap= "Z-Scores Parametros")


#install.packages("nortest") 
#install.packages("MKinfer")

library(ggplot2)
library(ggExtra)
library(nortest)             # Carrega o pacote para lilletest
library(readxl)
library(MKinfer)

getwd()

data <- readxl::read_excel("./BPAs_EscoreZ.xlsx")
 
data 
```

# **Checking differences between groups**
## **Scores/Z-Score** {.tabset .tabset-fade}
### BPA_CONC_EscoreZ                                                  #variavel avaliada
<p style="color:red; background-color:black;">**Many Different**</p>   #iguais ou diferentes

```{r}

## mann  whitney pq nao?

#hist(data$BPA_CONC_EscoreZ, breaks = 15, xlab = "BPA_CONC_EscoreZ", main="BPA_CONC_EscoreZ")

media <- mean(data$BPA_CONC_EscoreZ)
desvio <- sd(data$BPA_CONC_EscoreZ)

p <- ggplot(data, aes(x = BPA_CONC_EscoreZ)) +
  geom_histogram(aes(y = after_stat(density)), bins = 15, fill = "lightblue", color = "black") +
  stat_function(fun = dnorm, args = list(mean = media, sd = desvio), color = "tomato", size = 1.5) +
  
  labs(x = "BPA_CONC_EscoreZ", 
       y = "Density", 
       title = "BPA CONC Z-escore, Gaussian Density Curve") +
  theme_minimal()
p

lillie.test(data$BPA_CONC_EscoreZ)

shapiro.test(data$BPA_CONC_EscoreZ)

      #     TEST-T MUTIPLAÇÃO POR SIMULAÇÕES  FAORECENDO A TENDENCIA A SE APROXIMAR DE UMA AMOSTRA PARAMETRICA
          #   NÃO É TAO RIGOROSO!
boot.t.test(BPA_CONC_EscoreZ ~ GROUP, data)

```



# **Checking differences between groups**
## **Scores/Z-Score** {.tabset .tabset-fade}
### BPA_DIVID_EscoreZ                                                  #variavel avaliada
<p style="color:red; background-color:black;">**Many Different**</p>   #iguais ou diferentes

```{r}

#hist(data$BPA_DIVID_EscoreZ, breaks = 15, xlab = "BPA_DIVID_EscoreZ", main="BPA_DIVID_EscoreZ")


media <- mean(data$BPA_DIVID_EscoreZ)
desvio <- sd(data$BPA_DIVID_EscoreZ)

p <- ggplot(data, aes(x = BPA_DIVID_EscoreZ)) +
  geom_histogram(aes(y = after_stat(density)), bins = 15, fill = "lightblue", color = "black") +
  stat_function(fun = dnorm, args = list(mean = media, sd = desvio), color = "tomato", size = 1.5) +
  
  labs(x = "BPA_DIVID_EscoreZ", 
       y = "Density", 
       title = "BPA DIVID Z-escore, Gaussian Density Curve") +
  theme_minimal()
p


lillie.test(data$BPA_DIVID_EscoreZ)

shapiro.test(data$BPA_DIVID_EscoreZ)

boot.t.test(BPA_DIVID_EscoreZ ~ GROUP, data)

```




# **Checking differences between groups**
## **Scores/Z-Score** {.tabset .tabset-fade}
### BPA_ALTERN_EscoreZ                                                  #variavel avaliada
<p style="color:red; background-color:black;">**Many Different**</p>   #iguais ou diferentes

```{r}

#hist(data$BPA_ALTERN_EscoreZ, breaks = 15, xlab = "BPA_ALTERN_EscoreZ", main="BPA_DIVID_EscoreZ")

media <- mean(data$BPA_ALTERN_EscoreZ)
desvio <- sd(data$BPA_ALTERN_EscoreZ)

p <- ggplot(data, aes(x = BPA_ALTERN_EscoreZ)) +
  geom_histogram(aes(y = after_stat(density)), bins = 15, fill = "lightblue", color = "black") +
  stat_function(fun = dnorm, args = list(mean = media, sd = desvio), color = "tomato", size = 1.5) +
  
  labs(x = "BPA_ALTERN_EscoreZ", 
       y = "Density", 
       title = "BPA ALTERN Z-escore, Gaussian Density Curve") +
  theme_minimal()
p

lillie.test(data$BPA_ALTERN_EscoreZ)

shapiro.test(data$BPA_ALTERN_EscoreZ)

boot.t.test(BPA_ALTERN_EscoreZ ~ GROUP, data)

```         



# **Checking differences between groups**
## **Scores/Z-Score** {.tabset .tabset-fade}
### BPA_TOTAL_EscoreZ                                                  #variavel avaliada
<p style="color:red; background-color:black;">**Many Different**</p>   #iguais ou diferentes   

```{r}

# Trying to calculate the confidence interval

limite_inferior <- media - 1.96 * desvio / sqrt(length(data$BPA_TOTAL_EscoreZ))
limite_superior <- media + 1.96 * desvio / sqrt(length(data$BPA_TOTAL_EscoreZ))

################################################################################

media <- mean(data$BPA_TOTAL_EscoreZ)
desvio <- sd(data$BPA_TOTAL_EscoreZ)

p <- ggplot(data, aes(x = BPA_TOTAL_EscoreZ)) +
  geom_histogram(aes(y = after_stat(density)), bins = 15, fill = "lightblue", color = "black") +
  stat_function(fun = dnorm, args = list(mean = media, sd = desvio), color = "tomato", size = 1.5) +
  
  labs(x = "BPA_TOTAL_EscoreZ", 
       y = "Density", 
       title = "BPA Total Z-escore, Gaussian Density Curve") +
  theme_minimal()
p


lillie.test(data$BPA_TOTAL_EscoreZ)

shapiro.test(data$BPA_TOTAL_EscoreZ)
          
boot.t.test(BPA_TOTAL_EscoreZ ~ GROUP, data)

```


# **Checking differences between groups**
## **Scores/Z-Score** {.tabset .tabset-fade}
### FDT_READING_TIME_Z                                                  #variavel avaliada
<p style="color:red; background-color:black;">**Many Different**</p>   #iguais ou diferentes   

```{r}

###########################  FDT Norm ###################################

data <- readxl::read_excel("./FDT_EscoreZ.xlsx")

data <- na.omit(data)


media <- mean(data$FDT_READING_TIME_Z)
desvio <- sd(data$FDT_READING_TIME_Z)

p <- ggplot(data, aes(x = FDT_READING_TIME_Z)) +
  geom_histogram(aes(y = after_stat(density)), bins = 15, fill = "lightblue", color = "black") +
  stat_function(fun = dnorm, args = list(mean = media, sd = desvio), color = "tomato", size = 1.5) +
  
  labs(x = "FDT_READING_TIME_Z", 
       y = "Density", 
       title = "BPA Total Z-escore, Gaussian Density Curve") +
  theme_minimal()
p



#hist(data$FDT_READING_TIME_Z, breaks = 15, xlab = "FDT_READING_TIME_Z", main="FDT_READING_TIME_Z")

lillie.test(data$FDT_READING_TIME_Z)

shapiro.test(data$FDT_READING_TIME_Z)
          
boot.t.test(FDT_READING_TIME_Z ~ GROUP, data)

```


# **Checking differences between groups**
## **Scores/Z-Score** {.tabset .tabset-fade}
### FDT_COUNTING_TIME_Z                                                  #variavel avaliada
<p style="color:red; background-color:black;">**Many Different**</p>   #iguais ou diferentes   

```{r}


hist(data$FDT_COUNTING_TIME_Z, breaks = 15, xlab = "FDT_COUNTING_TIME_Z", main="FDT_COUNTING_TIME_Z")

lillie.test(data$FDT_COUNTING_TIME_Z)

shapiro.test(data$FDT_COUNTING_TIME_Z)
          
boot.t.test(FDT_COUNTING_TIME_Z ~ GROUP, data)

```



# **Checking differences between groups**
## **Scores/Z-Score** {.tabset .tabset-fade}
### FDT_CHOOSING_TIME_Z                                                  #variavel avaliada
<p style="color:red; background-color:black;">**Many Different**</p>   #iguais ou diferentes   

```{r}

hist(data$FDT_CHOOSING_TIME_Z, breaks = 15, xlab = "FDT_CHOOSING_TIME_Z", main="FDT_CHOOSING_TIME_Z")

lillie.test(data$FDT_CHOOSING_TIME_Z)

shapiro.test(data$FDT_CHOOSING_TIME_Z)
          
boot.t.test(FDT_CHOOSING_TIME_Z ~ GROUP, data)

```


# **Checking differences between groups**
## **Scores/Z-Score** {.tabset .tabset-fade}
### FDT_CHANGING_TIME_Z                                                  #variavel avaliada
<p style="color:red; background-color:black;">**Many Different**</p>   #iguais ou diferentes   

```{r}

hist(data$FDT_CHANGING_TIME_Z, breaks = 15, xlab = "FDT_CHANGING_TIME_Z", main="FDT_CHANGING_TIME_Z")

lillie.test(data$FDT_CHANGING_TIME_Z)

shapiro.test(data$FDT_CHANGING_TIME_Z)
          
boot.t.test(FDT_CHANGING_TIME_Z ~ GROUP, data)

```


# **Checking differences between groups**
## **Scores/Z-Score** {.tabset .tabset-fade}
### FDT_INHIBITION_Z                                                  #variavel avaliada
<p style="color:red; background-color:black;">**Many Different**</p>   #iguais ou diferentes   

```{r}

hist(data$FDT_INHIBITION_Z, breaks = 15, xlab = "FDT_INHIBITION_Z", main="FDT_INHIBITION_Z")

lillie.test(data$FDT_INHIBITION_Z)

shapiro.test(data$FDT_INHIBITION_Z)
          
boot.t.test(FDT_INHIBITION_Z ~ GROUP, data)

```

# **Checking differences between groups**
## **Scores/Z-Score** {.tabset .tabset-fade}
### FDT_FLEXIBILITY_Z                                                  #variavel avaliada
<p style="color:red; background-color:black;">**Many Different**</p>   #iguais ou diferentes   

```{r}

hist(data$FDT_FLEXIBILITY_Z, breaks = 15, xlab = "FDT_FLEXIBILITY_Z", main="FDT_FLEXIBILITY_Z")

lillie.test(data$FDT_FLEXIBILITY_Z)

shapiro.test(data$FDT_FLEXIBILITY_Z)
          
boot.t.test(FDT_FLEXIBILITY_Z ~ GROUP, data)

```